import{W as y,_ as n,u as S,r as b,j as e,R as _,o as C,b as L,c as f}from"./app-blqcz2ka.js";import{L as w,S as N}from"./Toast-jZpznciG.js";import{s as k}from"./showToast-G_kMG87d.js";import{i as F}from"./index.esm-gClIFQjr.js";import"./iconBase-NO4qN-QB.js";const I=({products:m,selectedProduct:c,handleSelectProduct:u})=>{const[r,o]=b.useState(""),[h,x]=b.useState([]),l=n.differenceWith(m,c,n.isEqual),p=a=>{const i=a.target.value;o(i);const g=l.filter(d=>((d==null?void 0:d.product_name)??"").toLowerCase().includes(i.toLowerCase()));x(g)};return e.jsxs("div",{className:"mt-5",children:[e.jsx("input",{type:"text",placeholder:"Search products",value:r,onChange:p}),e.jsx("ul",{className:"max-h-[30vh] min-h-[10vh] overflow-y-auto mt-3 p-1 ",children:h.length>0?h.map((a,i)=>e.jsxs(_.Fragment,{children:[e.jsxs("li",{onClick:()=>u(a),className:"cursor-pointer bg-sub-background pl-7 text-sm  hover:bg-sub hover:text-primary flex gap-3",children:[e.jsx("img",{src:(a==null?void 0:a.image)||"https://shelf-hawk-web-1.s3.amazonaws.com/shelf-hawk-web-1/storage/products/images/default.jpg",className:"w-10 h-10"}),e.jsxs("div",{children:[e.jsx("b",{children:a.product_name}),e.jsx("div",{className:"max-w-[80%] text-ellipsis",children:a.item_description??""})]})]},a.product_name),i!=h.length-1&&e.jsx("hr",{className:"p-0 my-1"})]},i+a.product_id)):l.map((a,i)=>e.jsxs(_.Fragment,{children:[e.jsxs("li",{onClick:()=>u(a),className:"cursor-pointer bg-sub-background pl-7 text-sm  hover:bg-sub hover:text-primary flex gap-3",children:[e.jsx("img",{src:(a==null?void 0:a.image)||"https://shelf-hawk-web-1.s3.amazonaws.com/shelf-hawk-web-1/storage/products/images/default.jpg",className:"w-10 h-10"}),e.jsxs("div",{children:[e.jsx("b",{children:a.product_name}),e.jsx("div",{className:"max-w-[80%] text-ellipsis",children:a.item_description??""})]})]},a.product_name),i!=l.length-1&&e.jsx("hr",{className:"p-0 my-1"})]},i+a.product_id))})]})},D=({handleCloseModal:m,locations:c,products:u})=>{var d,v;const{data:r,setData:o}=y({products:{},location_start:((d=c[0])==null?void 0:d.location_id)??1,location_end:((v=c[0])==null?void 0:v.location_id)??1}),h=u.filter(s=>{const t=JSON.parse(s.locations);if(n.some(t,j=>j.location_id===r.location_start))return s}),x=S(),[l,p]=b.useState([]),a=s=>{s.preventDefault(),x(C()),n.isEmpty(r.products)||L.post("/products/transfer",r).then(t=>{m(),k(t.data),window.location.reload(),x(f())}).catch(t=>{m(),k(t.response.data),x(f())})},i=s=>{s.preventDefault(),m()},g=s=>{p([...l,s])};return e.jsxs("form",{onSubmit:a,className:"gap-2 grid",children:[e.jsxs("div",{className:"form-item grid grid-cols-2 grid-flow-row gap-1",children:[e.jsxs("span",{children:[e.jsx("div",{className:"block capitalize pb-1 pl-2",children:e.jsx(w,{htmlFor:"location_start",value:"Location start"})}),e.jsx(N,{id:"location_start",className:"bg-sub-background",onChange:s=>{o("location_start",parseInt(s.target.value)),p(l.filter(t=>{if(n.some(JSON.parse(t.locations),j=>j.location_id===parseInt(s.target.value)))return t}))},value:r.location_start,children:c.map(s=>e.jsx("option",{value:s.location_id,children:s.location_name},`${s.location_id}-start`))})]}),e.jsxs("span",{children:[e.jsx("div",{className:"block capitalize pb-1 pl-2",children:e.jsx(w,{htmlFor:"location_end",value:"Location end"})}),e.jsx(N,{className:"bg-sub-background",value:r.location_end,onChange:s=>o("location_end",parseInt(s.target.value)),children:c.map(s=>e.jsx("option",{value:s.location_id,children:s.location_name},`${s.location_id}-end`))})]})]}),e.jsx("ul",{children:l.map(s=>e.jsxs("li",{className:" border-y-[1px] py-3 flex justify-between items-center px-3 md:px-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:(s==null?void 0:s.image)||"https://shelf-hawk-web-1.s3.amazonaws.com/shelf-hawk-web-1/storage/products/images/default.jpg",className:"w-10 h-10"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm md:text-base",children:s.product_name}),e.jsx("p",{className:"text-xsm",children:s.item_description})]})]}),e.jsxs("div",{children:[e.jsx("input",{className:"w-20 border border-opacity-20",type:"number",onChange:t=>{parseInt(t.target.value)<0&&(t.target.value="0"),o("products",{...r.products,[s.product_id]:{product_id:s.product_id,quantity:parseInt(t.target.value)<0?0:parseInt(t.target.value),sku:s.sku??""}})},required:!0}),e.jsx("button",{className:"text-danger hover:text-[var(--danger-button-hover)]",onClick:()=>{p(n.reject(l,{product_id:s.product_id})),o("products",n.omit(r.products,s.product_id))},children:e.jsx(F,{})})]})]},`${s.product_id}-selected`))}),e.jsx(I,{products:h,selectedProduct:l,handleSelectProduct:g}),e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-row-reverse",children:[e.jsx("button",{type:"submit",className:"bg-info",disabled:n.isEmpty(r.products),children:"submit"}),e.jsx("button",{className:"bg-danger",onClick:i,children:"cancel"})]})]})};export{D as default};
