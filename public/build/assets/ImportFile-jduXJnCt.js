import{r as p,j as e,_ as d,q as k,u as F,W as S,o as u,b as g,c as m,n as _}from"./app-blqcz2ka.js";import{L as y,F as D,S as E,C as L}from"./Toast-jZpznciG.js";import{j as I,t as T,u as A}from"./index.esm-gClIFQjr.js";import{i as j}from"./type-gQcyAYx5.js";import{s as b}from"./showToast-G_kMG87d.js";import"./iconBase-NO4qN-QB.js";function V({handleImport:l}){const[c,a]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex w-[80%]  items-center justify-center mx-auto ",children:e.jsxs(y,{htmlFor:"dropzone-file",className:"dark:hover:bg-bray-800 flex h-32 w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-gray-500 dark:hover:bg-gray-600",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pb-6 pt-5",children:[e.jsx(I,{className:"mb-4 h-8 w-8 text-gray-500 dark:text-gray-400"}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500 dark:text-gray-400 max-sm:text-xsm",children:[e.jsx("span",{className:"font-semibold",children:"Click to upload"})," ","or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"CSV file"})]}),e.jsx(D,{id:"dropzone-file",className:"hidden",onChange:r=>{var n;((n=d.head(r.target.files))==null?void 0:n.type)!=="text/csv"?a(!0):(a(!1),l(r))},accept:".csv"})]})}),c&&e.jsxs("div",{className:"text-danger text-sm pl-5",children:["File must have extention ",e.jsx("b",{children:".csv"})]})]})}const H=({type:l})=>{var h,f;const{auth:c}=k().props,a=F(),r=new FormData,[n,v]=p.useState({}),{data:t,setData:i}=S({type:l||j[0],file:{},is_template:!1});p.useEffect(()=>{a(u()),g.get(route("template")).then(s=>{v(s.data),a(m())})},[]);const N=s=>{i("file",s.target.files[0])},x=()=>{a(_())},C=()=>{var s;a(u()),r.append("file",t.file),r.append("type",t.type.toLowerCase().replaceAll(" ","_")),r.append("is_template",t.is_template?"1":"0"),d.isEmpty((s=t.file)==null?void 0:s.name)||g.post(route("import"),r,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>{a(m()),b(o.data),window.location.reload()}).catch(o=>{a(m()),b(o.response.data)}).finally(()=>x())},w=s=>{s.preventDefault();const o=t.type.toLowerCase().replaceAll(" ","_");window.open(`https://shelf-hawk-web-1.s3.amazonaws.com/${n[o]}`)};return e.jsxs("div",{className:"bg-sub-background xsm:text-xsm md:text-sm px-6 py-4 grid gap-2 ",children:[e.jsx("h1",{className:"font-bold text-center",children:"Import data"}),e.jsxs("div",{children:[e.jsx("p",{children:"Shelf Hawk can import spreadsheet data if it's saved as a CSV file."}),e.jsxs("p",{className:"mt-4",children:["If your spreadsheet is not in CSV format yet, you can use Microsoft Excel or Google Sheets and save it as a CSV.",e.jsx("a",{href:"#",className:"text-link ml-1",children:"Learn more"})]})]}),e.jsx("div",{className:"divider",style:{borderColor:"var(--sub-color)"}}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("b",{children:"Data type"}),d.isEmpty(l)&&e.jsxs(E,{id:"data-type",className:"ml-4",onChange:s=>{i("type",s.target.value)},children:[j.map(s=>e.jsx("option",{value:s,children:s},s.replaceAll(" ","_")))," "]})]}),e.jsxs("div",{className:"bg-sub-backgound mt-2",children:[e.jsx("p",{className:"text-sm px-1",children:"Need help getting started? Download our simple template."}),e.jsxs("button",{onClick:s=>w(s),className:"text-link flex items-baseline gap-1",children:[e.jsx(T,{})," Download ",t.type," import template"]})]})]}),e.jsx("div",{className:"divider",style:{borderColor:"var(--sub-color)"}}),d.isEmpty((h=t.file)==null?void 0:h.name)?e.jsx(V,{handleImport:N}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border flex justify-between rounded-lg p-1 pl-3",children:[e.jsx("span",{children:(f=t.file)==null?void 0:f.name}),e.jsx("button",{className:"text-danger",onClick:()=>{i("file",{})},children:e.jsx(A,{})})]}),!!c.user.is_admin&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(L,{id:"template",name:"is_template",onChange:s=>i("is_template",!t.is_template)}),e.jsx(y,{htmlFor:"template",children:"Upload template"})]})]}),e.jsx("div",{className:"divider",style:{borderColor:"var(--sub-color)"}}),e.jsxs("div",{className:"flex flex-row-reverse",children:[e.jsx("button",{className:"bg-info btn-sm",onClick:C,children:"accept"}),e.jsx("button",{className:"bg-danger btn-sm",onClick:()=>{x()},children:"cancel"})]})]})};export{H as default};
